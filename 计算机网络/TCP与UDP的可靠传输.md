# TCP与UDP的可靠传输

https://blog.csdn.net/gettogetto/article/details/76736365

https://zhuanlan.zhihu.com/p/68466363

## 1、TCP的可靠传输

> 应用数据被分割成TCP认为最适合发送的数据块。这和UDP完全不同，应用程序产生的数据长度将保持不变。由TCP传递给IP的信息单位称为报文段或段（segment）。

### &sect; 确认重传机制

TCP协议用于控制数据段是否需要重传的依据是设立重发定时器。在发送一个数据段的同时启动一个重传，如果在重传超时前收到确认(Acknowlegement)就关闭该重传，如果重传超时前没有收到确认，则重传该数据段。<mark>在选择重发时间的过程中，TCP必须具有自适应性。它需要根据互联网当时的通信情况，给出合适的重发时间。</mark>

这种重传策略的关键是对定时器初值的设定。采用较多的[算法](http://lib.csdn.net/base/datastructure)是Jacobson于1988年提出的一种不断调整超时时间间隔的动态算法。其工作原理是：<font color='red'>对每条连接TCP都保持一个变量RTT（Round Trip Time），用于存放当前到目的端往返所需要时间最接近的估计值。当发送一个数据段时，同时启动连接的定时器，如果在定时器超时前确认到达，则记录所需要的时间（M），并修正[2] RTT的值，如果定时器超时前没有收到确认，则将RTT的值增加1倍。通过测量一系列的RTT（往返时间）值，TCP协议可以估算数据包重发前需要等待的时间。在估计该连接所需的当前延迟时通常利用一些统计学的原理和算法（如Karn算法），从而得到TCP重发之前需要等待的时间值。</font>

------

### &sect; 滑动窗口

> 滑动窗口是一种流量控制技术，接收方可以通过反馈来指示发送方调节数据发送的速度。TCP中使用滑动窗口协议来控制发送的数据量，达到理想的传输速度。

------

### &sect; 拥塞控制

> - 慢启动
>
>   在连接刚建立时接收==窗口以指数方式增加==，直到达到慢启动的阀值，或者是遇到丢包，开始进入拥塞回避阶段。
>
> - 拥塞回避
>
>   在此阶段会使用AIMD(Additive Increase Multiplicative Decrease)方式==调整窗口大小==，通过线性增加和指数衰减，逐渐逼近和收敛到一个理想值，从而达到充分利用带宽但又不引起拥塞的状态。
>
> - 快重传
>
>   发送方如果收到<font color='red'>**连续3次重复的ACK确认，就认为出现了丢包，而不需要等到重传计时器超时**</font>。这样可以更早的检测到丢包，提高算法效率。
>
> - 快恢复
>
>   Tahoe检测到丢包后，会回到初始状态，然后进入慢启动阶段，导致传输效率太低。Reno对此作了改进，<font color='red'>**在检测到丢包后，直接进入拥塞回避阶段，将窗口大小调整为原来的一半，避免了慢启动的开销**</font>。

------

## 2、UDP可可靠传输

> <font color='red'>***通过应用层来实现,实现的方式可以参照tcp可靠性传输的方式，只是实现不在传输层，实现转移到了应用层。***</font>
>
> 实现确认机制、重传机制、窗口确认机制。
>
> 如：UDT

